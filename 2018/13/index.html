<!DOCTYPE html>

<head>
  <script src="../../help.js"></script>
  <style>
    pre {
      /* font-size: 4px; */

    }

    .highlight {
      background: greenyellow;
      color: black;
    }
  </style>
</head>

<body style="background:#333;color:aliceblue;">
  <pre>check console</pre>
</body>
<script>
  "use strict";

  const input =
    `                   /----------t                                                                                                /--------------------t 
             /-----+----------+-------------->t                                                                                |                    | 
             |     |          |               |                        /---------------------------------------------------t   |                    | 
/------------+-----+----------+----------t    |                        |                                                   |   |                    | 
|            |     |          | /--------+----+-------------------t    |               /--------------------t              |   |                    | 
|            |     |          | |        |    |                   |    |               |              /-----+--------------+--t|                    | 
|  /---------+-----+------t   | |        |    |                   |    |               |              |     |              |  ||                    | 
|  |      /--+-----+------+---+-+--------+----+-------------t     |    |               |              |     |              |  ||                    | 
|  |      |  |     |      |   | |    /---+----+-------------+-----+----+---------------+-------t      |     |              |  ||  /-------------t   | 
|  |      |  |     |     /+---+-+----+---+----+--t       /--+-----+----+---------------+-------+------+-----+--------------+--++--+-------------+-t | 
|  |     /+--+-----+-----++---+-+----+---+----+--+-------+--+-----+----+---------------+--t    |      |     |              |  ||  |             | | | 
|  |     ||  |     |     ||   | |    |   v    |  |       |/-+-----+----+---------------+--+----+t     |     |              |  ||  |             | | | 
|  |     ||  |   /-+-----++---+-+----+---+----+--+-------++-+-----+----+---------------+--+--t ||     |     |              |  ||  |             | | | 
|  |     ||  |   | |     ||   | |    |   |    |  |       || |     |    |               |  |  | ||     |     |              |  ||  |             | | | 
|  |     ||  |   | |     ||   | |    |   |    |  |   /---++-+-----+----+----------t    |  |  | ||/----+----t|              |  ||  |             | | | 
|  |     ||  |   | |     ||   | |    |   |    |  |   |   || |     |    |          | /--+--+--+-+++----+----++--------------+--++--+-------------+t| | 
|  |     ||  |   | |     ||   | t----+---+----+--+---+---++-+-----/    |          | |  |  |  | |||    |    ||              |  ||  |             ||| | 
|  |     ||  |   |/+-----++---+------+---+----+--+---+---++-+-t        |          | |  |  |  | |||    |    ||/-------------+--++--+---t         ||| | 
|  |     ||  |   ^||     ||   |      |/--+----+-t|   |   || | |        |          | | /+--+--+-+++----+----+++-------------+--++--+---+-------t ||| | 
|  |     ||  t---+++-----++---+------++--+----/ ||   |   || | |   /----+----------+-+-++--+--+t|||    |    |||             |  |t--+---+-------+-+++-/ 
|  |     ||      |||     ||   |      ||  |      ||   |   || | |   |    |        /-+-+-++--+--+++++----+----+++-------------+--+-t |   |       | |||   
|  |     ||      ||| /---++---+------++--+------++---+t  || | |   |    |/-------+-+-+-++--+--+++++-<--+----+++------t      |  | | |   |       | |||   
|  | /---++------+++-+---++---+------++--+t     ||  /++--++-+-+---+----++-------+-+-+-++--+--+++++----+----+++------+------+--+-+-+---+-----t | |||   
|  | |   ||      |||/+---++---+------++--++-----++--+++--++-+-+t  |    ||       |/+-+-++--+--+++++----+----+++------+------+--+-+-+---+--t  | | |||   
|  | |   ||      |||||   t+---+------++--++-----+/  |||  || | ||  |    ||       ||| | || /+--+++++----+----+++------+------+--+-+-+--t|  |  | | |||   
|  | |   ||      |||||    |   |      ||  ||     |   |||  || |/++--+----++-------+++-+-++-++--+++++----+----+++------+------+--+t| |  ||  |  | | |||   
|  | |   ||      |||||    |   |      ||  ||  /--+---+++--++-++++--+----++-------+++-+-++-++--+++++--->+----+++------+------+--+++-+--++--+--+-+-+++--t
|  | |  /++------+++++----+---+------++--++--+--+---+++--++-++++--+---t||  /----+++-+-++-++--+++++----+----+++------+------+--+++-+--++--+--+-+-+++t |
|  | |  |||      |||||    |   |      ||  ||  |  |   |||  || ||||  |   |||  |    ||| | || ||  |||||    |    |||      |      |  ||| |  ||  |  | | |||| |
|  | |  |||      |||||    |   |      ||  ||/-+--+---+++--++-++++--+t  |||  |    ||| | || ||  |||||    |    |||      |      |  ||| |  ||  |  | | |||| |
|  | |  ||| /----+++++----+---+------++--+++-+--+---+++--++-++++-t||  |||  |    ||| | || ||  |||||    |    |||      |      |  ||| |  ||  |  | | |||| |
|/-+-+--+++-+----+++++----+---+------++--+++t| /+---+++--++-++++-+++--+++--+----+++-+-++-++--+++++----+----+++------+----t |  ||| |  ||  |  | | |||| |
|| | |  ||| |    |||||    | /-+------++--+++++-++---+++t || |||| |||  |||/-+----+++-+-++t||  |||||  /-+----+++-t    |    | |  ||| |  ||  |  | | |||| |
|| | | /+++-+----+++++-t  | | |      ||/-+++++-++---++++-++-++++-+++--++++-+----+++-+-+++++--+++++->+-+----+++-+----+---t| |  ||| |  ||  |  | | |||| |
|| | | |||| |    ||||| |  | | |     /+++-+++++-++---++++-++-++++-+++-t|||| |    ||| | |||||  |||||  | |    ||| |    |   || |  ||| |  ||  |  | | |||| |
|| | | |||| |    ||||| |  | | |     |||| ||||| ||   |||| || |||| ||| ||||| |    ||| | |||t+--+++++--+-+----+++-+----+---++-+--+++-+--/|  |  | | |||| |
|| | | |||| |    ||||| |  | | |     |||| ||||| v|   |||| || |||| ||| ||||| |    ||| | ||| |  |||||  | t----+++-+----+---++-+--/|| t---+--+--+-+-/||| |
|| | | |||| |    ||||| |  | | |     |||| ||||| ||   t+++-++-++++-+++-+++++-+----+++-+-+++-+--+++++--+------+++-+----+---++-+---++-----+--+--/ |  ||| |
|| | | |||| |    ||||| |  | | |     |||| ||||| ||    ||| || |||| ||| ||||| |    ||| | |||/+--+++++--+----t ||| |    |   || |   ||     |  |    |  ||| |
|| | | |||| |    ||||| |  | | |     |||| |||||/++----+++-++-++++-+++-+++++-+----+++-+-+++++--+++++--+----+-+++-+----+--t|| |   ||     |  |    |  ||| |
|| | | |||| |   /+++++-+--+-+-+-t   ||||/++++++++----+++-++-++++-+++-+++++-+----+++-+-+++++--+++++--+----+-+++t|    |  ||| |   ||     |  |    |  ||| |
|| | |/++++-+---++++++-+--+-+-+-+---+++++++++++++----+++-++-++++-+++t||||| |    ||| | |||||  |||||  |    | |||||    |  ||| |   ||     |  |    |  ||| |
|| | |||||| |   |||||| |  | | |/+---+++++++++++++----+++-++-++++-+++++++++-+----+++-+-+++++--+++++t |    | |||||    |  |||/+---++---t |  |    |  ||| |
|| | ||||t+-+---++++++-+--+-+-+++---+++++++++++++----+++-++-++++-+++++++++-+----+++-+-++++/  |||||| |    | |||||    |  |||||   ||   | |  |    |  ||| |
|| | t+++-+-+---++++++-+--+-+-+++---++++++/||||||    ||| || |||| ||||||||| |    ||| | |t++---++++++-+----+-+/|||    |/-+++++---++---+-+--+--t |  ||| |
|| |  ||| | |   |||||| |  | | |||   |||||| ||||t+----+++-++-++++-+++++++++-+----+++-+-+-++---++++++-+----+-+-+++----++-++/||   ||   | |  |  | |  ||| |
|| |  ||| | |/--++++++-+--+-+-+++---++++++-++++-+---t||| || |||| |||||||^| |    ||| | | ||   |||||| |    | | |||    || || ||   ||   | |  |  | |  ||| |
||/+--+++-+-++--++++++-+--+-+-+++-t |||||| |||| |   |||| || |||| ||||||||| |    ||| | | ||   |||||| |    | | |||    || || ||   ||   | |  |  | |  ||| |
|||^  ||| |/++--++++++-+--+-+-+++-+-++++++-++++-+---++++-++-++++-+++++++++-+----+++-+-+-++---++++++-+----+-+-+++-t  || || ||   ||   | |  |  | |  ||| |
||||  ||| ||||  |||t++-+--+-+-/||/+-++++++-++++-+---++++-++-++++-+++++++++-+-t  t++-+-+-++---++++++-+----+-+-+++-+--++-++-++---+/   | |  |  | |  ||| |
||||  ||| ||||  ||| || |  | |  |||| |||||| |||| |   |||| || |||| ||||||||| | |/--++-+-+-++---++++++-+----+-+-+++-+--++-++-++t  |    | |  |  | |  ||| |
||||  ||| ||||  ||| || |/-+-+--++++-++++++-++++-+---++++-++-++++-+++++++++-+-++--++-+-+-++---++++++-+----+-+-+++-+-t|| || |||  |    | |  |  | |  ||| |
||||  ||| ||||  ||| || || | |  |||| |||||| |||| |   |||| || |||| ||||||||| | ||  || | | ||   |||||| |    | | ||| | ||| || |||  |    | |  |  | |  ||| |
||||  ||| ||||  ||| || || | |  |||| |||||| |||| |   |||| || |||| ||||||||| | ||  || | | ||   |||||| |    | | ||| | ||| || |||  |    | |  |  | |  ||| |
||||  ||| ||||  ||| || || | |  |||| |||||| ||||/+---++++-++-++++-+++++++++-+-++--++-+-+-++---++++++-+----+-+-+++-+-+++-++-+++--+----+-+--+--+t|  ||| |
||||  ||| ||||  ||| || || | |  |||| |||||| ||||||   |||| || |||| ||||||||| | ||  || | | ||   |||||| |    | | ||| | ||| || |||  |    | |  |  |||  ||| |
t+++--+++-++++--+++-++-++-+-+--++++-+++++/ ||||||   |||| || |t++-+++++++++-+-++--++-+-+-++---++++++-+----+-+-+++-+-+++-++-+++--/    | |  |  |||  ||| |
 |||  ||| |t++--+++-++-++-+-+--++++-+++++--++++++---++++-++-+-++-+++++++++-+-++--++-+-+-++---++++++-+----+-+-+++-/ ||| || |||       | |  |  |||  ||| |
/+++--+++-+-++--+++-++-++-+-+--++++-+++++--++++++---++++-++-+t|| ||||||||| t-++--++-+-+-++---++++++-+----+-+-+++---+++-++-+++-------+-+--+--+++--++/ |
||||  ||| | ||  ||| t+-++-+-+--++++-+++++--++++++---++++-++-+++/ |||||||||   ||  || | | ||   |||||| |    | | t++---+++-++-+++-------+-/  |  |||  ||  |
||||  ||| | ||  |||  | || | |  |||| |||||  ||||||   |||| || |||  |||||||||   ||  || | | ||   |||||| |    | |  ||   ||| || |||       |    |  |||  ||  |
||||  ||| | ||  |||  | || | |  |||| |||t+--++++++---++++-++-+++--+++++++++---++--++-+-+-++---++++++-+----+-+--++---+++-+/ |||   /---+----+--+++--++-t|
||||  ||| | ||  |||  | || | |  |||| ||| |  ||||||   |||| || |||  |||||||||   ||  || | | ||   |||||| |    | |  ||/--+++-+--+++---+---+--t |  |||  || ||
||||  ||| | ||  |||/-+-++-+-+--++++-+++-+--++++++---++++-++-+++--+++++++++--t||  || | t-++---++++++-+----+-+--+++--+++-+--+++---+---+--+-+--++/  || ||
||||  ||| | ||  ||v| | || | |  |||| ||| |  t+++++---++++-++-+++--++/||||||  |||  || |   |t---++++++-+----/ |  |||  ||| |  |||   |   |  | |  ||   || ||
||||/-+++-+-++--++++-+-++-+-+--++++-+++-+---+++++---++++-++-+++--++-++++++--+++--++-+---+----++++++t|      |  |||  ||| |  |||   |   |  | |  ||   || ||
||||| ||| | ||  |||| | || | |  |||| |t+-+---+++++---++++-++-+++--++-++++++--+++--++-+---+----++/|||||      |  |||  ||| |  |||   |   |  | |  ||   || ||
||||| ||| | ||  |||| | || | |  |||| | | |   |||||   |||| || ||| /++-++++++--+++--++-+---+----++-+++++------+--+++-t||| |  |||   |   |  | |  ||   || ||
||||| ||| | ||  |||| | || | |/-++++-+-+-+---+++++---++++-++-+++-+++-++++++--+++--++-+---+----++-+++++---t  | /+++-++++-+t |||   |   |  | |  ||   || ||
||||| ||| | ||  |||| | || | || |||| | | |   |||||   |||| || ||| ||| ||||||  |||  || |   |    || ||||t---+--+-++/| |||| || |||   |   |  | |  ||   || ||
|||t+-+++-+-++--++++-+-++-//++-++++-+-+-+---+++++---++++-++-+++-+++-++++++--+++<-++-+---+----++-++++----+--+t|| | |||| || |||   |   |  | |  ||   || ||
||| | ||| | ||  |||| | ||/-+++-++++-+-+-+---+++++---++++-++-+++-+++-++++++--+++t || |   |    || ||||    |  |||| | |||| || |||   |   |  | |  ||   || ||
||| | ||| | ||  |||| | ||| ||| |||| | | |   |||||   |||| || ||| ||| ||||||  |||| || |   |    ||/++++----+--++++-+-++++-++-+++---+t  |  | |  ||   || ||
||| | ||| | ||  |||| | |||/+++-++++-+-+-+---+++++---++++-++-+++-+++-++++++--++++-++-+---+----+++++++----+--++++-+-++++-++-+++--t||  |  | |  ||   || ||
||| | ||| | ||  |||| | ||||||| |||| | | |   |||||   |||| || ||| ||| ||||||  |||| || |   |    ||||||| /--+--++++t| |||| || |||  |||  |  | |  ||   || ||
||| | ||| | ||  |||| | ||||||| |||| | | | /-+++++---++++-++-+++-+++-++++++--++++-++-+---+----+++++++-+--+--++++++-++++-++-+++--+++--+-t| |  ||   || ||
||| | ||| | ||  |||| | ||||||| |||| | | | | |||||   |||| || ||| ||| ||||||  |||| t+-+---+----+++++++-+--+--++++++-++++-++-+++--+++--+-++-/  ||   || ||
||| | ||| | ||  |t++-+-+++++++-++++-+-+-+-+-+++++---++++-++-+++-+++-++++++--++++--+-+---+----/||||||/+--+--++++++-++++-++-+++--+++--+-++----++-t || ||
||| | ||| | ||  | || | ||||||| |||| | |/+-+-+++++---++++-++-+++<+++-++++++--++++--+-+t  |     ||||||||  |  |||||| |||| || |||  |||  | ||    || | || ||
||| | ||| | ||  | || t-+++++++-++++-+-+++-+-+++++---++/| || ||| t++-++++++--++++--+-++--+-----++++++++--+--++++++-/||t-++-+++--+++--+-++----/| | || ||
||| | ||| | ||  | ||   ||||||| |||| | ||| | |||||   || |/++-+++--++-++++++--++++--+-++--+-----++++++++--+--++++++--++--++-+++--+++t | ||     | | || ||
||| | ||| | ||  | ||   ||||||| |||| | ||| | |||||   |t-++++-+++--++-++++++--++++--/ ||  |     |t++++++--+--++++++--++--++-+++--++/| | ||     | | || ||
|t+-+-+++-+-++--+-++---+++++++-++++-+-+++-+-/||||   |  |||| |||  || ||||||  ||t+----++--+-----+-++++++--+--++++++--++--++-++/  || | | ||     | | v| ||
| | | ||| | ||  | ||   |||||||/++++-+-+++-+--++++---+t |||| |||  ||/++++++--++-+----++--+-----+-++++++--+--++++++--++--++-++---++-+-+t||     | | || ||
| | | ||| | ||  | ||   |||||||||||| | ||| |  ||||   || |||| |||  |||||||||  || |    ||  |     | ||||||  |  ||||||  ||  || || /-++-+-++++-t   | | || ||
| | | ||| | ||  | ||   |||||||||||| | ||| |  ||||   ||/++++-+++--+++++++++--++-+----++--+-----+-++++++--+--++++++--++--++-++-+-++-+-++++-+t  | | || ||
| | | ||| t-++--+-++---++++++++++++-+-+++-+--++++---+++++++-/||  |||||||||  || |    ||  |   /-+-++++++--+--++++++--++--++-++-+-++-+-++++-++t | | || ||
| | | |||   ||  | ||   |||||||||||| | ||| |  ||||   |||||||  ||  |||||||||  || |    ||  |   | | ||||||  |  ||||||  ||  || || | || | |||| ||| | | || ||
| | | |||   ||  | ||   ||||||||t+++-+-+++-+--++++---+++++++--++--+++++++++--++-+----++--+---+-+-++/|||  |  ||||||  ||  || || | || | |||| ||| | | || ||
| | | |||   ||  | ||   |||||||| ||| | ||| |  ||||  /+++++++--++--+++++++++--++-+----++--+-->+-+t|| |||  |  ||||||  ||  || t+-+-++-+-/||| ||| | | || ||
| t-+-+++---++--+-++---++++++++-++/ | ||| |  ||||  ||||||||  ||  |t+++++++--++-+----++--+---+-/||| |||  |  ||||||  ||  ||  | | |t-+--+++-+++-+-+-++-/|
|   | |||   ||  | ||   ||||||t+-++--+-+++-+--++++--++++++++--++--+-+++++++--++-+----++--+---+--+++-+++--/  ||||||  ||  ||  | | |  |  ||| ||| | | ||  |
|   | |||   ||  | ||   ||||||/+-++--+-+++-+--++++--++++++++--++--+-+++++++--++-+----++--+--t|  ||| |||     ||||||  ||  ||  | | |/-+--+++-+++-+t| ||  |
|   | |||   || /+-++---++++++++-++--+-+++-+--++++--++++++++--++--+-+++++++--++-+----++--+--++--+++-+++-----++++++--++--++-t| | || |  ||| ||| ||| ||  |
|   | |||   || || ||   ||t+++++-++--+-+++-+--++++--++++++++--++--+-+++++++--++-/    ||  |  ||  |||/+++-----++++++--++--++-++t| || |  ||| ||| ||| ||  |
|   | |||   || || ||   || ||||| ||  | ||| |  ||||  ||||||||  ||  | |||||||  ||      ||  |  ||  |||||||     ||||||  ||  || |||| || |  ||| ||| ||| ||  |
|   | |||   || || ||   || ||||| ||  | ||| |  ||||  |||t++++--++--+-+++++++--++------++--+--++--+++++++-----++++++--++--++-++++-++-+--+++-+/| ||| ||  |
|   | |||   || || ||   || t++++-++--+-+++-+--++++--+++-++++--++--+-+++++++--++------++--+--++--+++++++-----++++++--++--++-++++-/| |  ||| | | ||| ||  |
|   t-+++---++-++-++---++--++++-++--+-+++-+--++++--+++-++++--++--+-+++++++--++------++--+--++--++++/t+-----++++++--++--++-++++--+-+--+++-+-+-++/ ||  |
|     |||   || || ||   ||  |||| |t--+-+++-+--++++--+++-++++--++--+-+++++++--+/      ||  |  ||  ||||  |     ||||||  ||  || ||||  | |  ||| | | ||  ||  |
|     |||   || || ||   ||  |||| |   | ||| |  ||||  ||| ||t+--++--+-+++++++--+-------++--+--++--++++--+-----++++++--++--++-++++--+-+--+++-+-+-++--+/  |
|     |||   || || ||   ||  |||| |   | ||| |  ||||  ||| || |  ||  | |||||||  |       t+--+--++--++++--+-----++++++--++--++-++++--+-+--+++-+-+-++--/   |
|     |||   || || ||   ||  |||| |   | ||| |  ||||  t++-++-+--++--+-+++++++--+--------+--+--++--/||^  |     ||||||  ||  || ||||  | |  ||| | | ||      |
|     |||   || |t-++---++--++++-/   | |t+-+--++++---++-++-+--++--+-+++++++--+--------/  |  ||   ||t--+-----++++++--++--++-++/|  | |  ||| | | ||      |
|     |||   || |  |t---++--++++-----+-+-+-+--++++---++-++-+--++--+-+++++++--/           |  ||   ||   |     ||||||  ||  || || |  | |  ||| | | ||      |
|/----+++-t || |  |    ||  t+++-----+-+-+-+--++++---++-++-+--++--+-+++++++--------------+--++---++---+-----+/||||  ||  || || |  | |  ||| | | ||      |
||    ||| | || |  |    ||   t++-----+-+-+-+--++++---++-/| |  ||  | |||||||              |  |t---++---+-----+-++++--++--++-++-+--+-+--+++-+-/ ||      |
||    ||| | || |  |    ||    ||     | | | |  ||||   ||  | |  ||  | |||||||              |  |    ||   |     | ||||  ||  || || |  | |  ||| |   ||      |
||    ||| | || |  |    ||    ||     | | | |  ||||   ||  | |  ||  | ||||t++--------------+--+----++---+-----+-++++--++--++-+/ |  | |  ||| |   ||      |
||    ||| | || |  |    ||    t+-----+-+-+-+--++++---++--+-+--++--+-++++-++--------------+--/    ||   |     | ||||  ||  || |  |  | |  ||| |   ||      |
||    ||| | || |  |    ||     |     | | t-+--++++---++--+-+--++--+-++++-++--------------+-------++---+-----+-+/||  ||  || |  |  | |  ||| |   ||      |
||    ||| | || |  |    ||     |     | |   |  ||||   ||  | |  ||  | |||| ||              |       ||   |     | | ||  ||  || |  |  | |  ||| |   ||      |
||    ||| | || |  |    ||     |     | |/--+--++++---++--+-+--++--+-++++-++------t       |       ||   |     | | ||  ||  || |  |  | |  ||| |   ||      |
||    ||| | t+-+--+----++-----+-----+-++--+--++++---++--+-+--++--/ |||| ||      |       |       ||   |     | | ||  ||  || |  |  | |  ||| |/--++-----t|
||    ||| |  | |  |    ||     |     | ||  |  ||||   ||  | t--++----++++-++------+-------+-------/|   |     | | ||  ||  || |  |  | |  ||| ||  ||     ||
|t----+++-/  | |  |    ||     |   /-+-++--+--++++---++--+----++----++++-++------+-------+--------+---+-----+-+-++--++--++-+--+--+-+--+++-++-t||     ||
|     |||    | |  t----++-----+---+-+-++--+--++++---++--+----+/    |||| ||      |       |        |   |     | | ||  ||  || |  |  t-+--+++-++-++/     ||
|     |||    | |       ||     |   | | ||  |  ||||   ||  |    |     |||| ||      |       |        |   |     | t-++--++--+/ |  |    |  ||| || ||      ||
|     |||    | |       ||     |   | t-++--+--++++---++--+----+-----++/| ||      |       |        |   |     |   ||  ||  |  |  |    |  ||| || ||      ||
|     |||    | |       |t-----+---+---++--+--++++---++--+----+-----++-+-++------+-------+--------+---+-----+---++--/|  |  |  |    |  ||| || ||      ||
|     |||    | |       |      |   |   ||  |  t+++---++--+----+-----++-+-++------+-------+--------+---+-----+---++---+--+--+--+----+--+++-++-++------+/
|     ||t----+-+-------+------+---+---++--+---+++---++--+----+-----++-/ ||      |       |        |/--+-----+---++---+--+--+--+----+t ||| || ||      | 
t-----++-----+-+-------+------+---+---++--+---+++---++--+----/     ||   ||      |       |        t+--+-----/   ||   |  |  |  |    || ||| || ||      | 
      ||     | |       |/-----+---+---++--+---+++---++--+----------++---++------+-------+---------+-t|         |t---+--+--+--+----++-++/ || ||      | 
      ||     | |       ||     |   |   t+--+---++/   ||  |   /------++---++------+-------+---------+-++---------+----+--+--+--+-t  || ||  || ||      | 
      ||     | |       ||     |   |    |  |   ||    ||  |   |      ||   ||      |       |         | ||         ^    |  |  |  | |  || ||  || ||      | 
      ||     t-+-------++-----+---+----+--+---++----/|  |   |      ||   ||      |       |         | ||         |    |  |  |  | |  || ||  || ||      | 
      ||       |       ||     |   |    |  t---++-----+--+---+------++---++------+-------+---------+-++---------+----+--+--+--+-+--++-+/  || ||      | 
      ||       |       ||     |   |    |      ||     |  |   |      ||   t+------+-------+---------+-++---------+----/  |  |  | |  || |   || ||      | 
      ||       |       ||     t---+----+------++-----/  |   |      ||    |      |       |         | ||/--------+-------+--+--+-+--++-+---++-++-----t| 
      ||       |       ||         |    |      ||        |/--+------++----+------+-------+---------+-+++--------+-------+--+--+-+--++-+---++-++-t   || 
    /-++-------+-------++---------+----+------++--------++--+------++----+------+-------+---------+-+++------t |       |  |  | |  || |   || || |   || 
    | ||    /--+-------++---------+----+------++--------++--+------++----+------+-------+--t      t-+++------+-+-------+--+--+-+--+/ |   || || |   || 
    | ||    |  |       ||         |    |      |t--------++--+------++----+------+-------+--+--------+++------+-+-------+--+--+-+--+--+---++-+/ |   || 
    | ||    |  |       |t---------+----+------+---------++--+------++----+------+-------+--+--------/||      | |       |  |  | |  |  |   || |  |   || 
    | ||    |  |       |          |    |      |         ||  |      ||    t------+-------/  |         t+------+-/       |  |  | |  |  |   || |  |   || 
    | ||    |  |       |          |    |      |  /------++--+------++-----------+----------+----------+------+---------+--+--+-+--+-t|   |t-+--+---+/ 
    | ||    |  |       |          |    |      t--+------++--+------++-----------+----------+----------+------+---------/  |  | |  | ||   |  |  |   |  
    | ||    |  |       |          |    |         |      t+--+------++-----------+----------+----------+------+------------+--+-+--/ ||   |  |  |   |  
    | |t----+--+-------/          |    |         |       t--+------++-----------+----------+----------+------+------------+--+-+----++---+--+--/   |  
    | |     |  |                  |    t---------+----------+------++-----------/          |          |      |            |  | |    ||   |  |      |  
    | |     t--+------------------+--------------+----------+------++----------------------/          |      |            |  | |    ||   |  |      |  
    | |        t------------------+--------------+----------+----->++---------------------------------+------+------------/  | |    ||   |  |      |  
    | |                           |              |          |      ||                                 |      |               t-+----++---/  |      |  
    t-+---------------------------+--------------+----------+------++---------------------------------+------/                 |    ||      |      |  
      |                           t--------------+----------+------++---------------------------------+------------------------+----++------/      |  
      t------------------------------------------+----------+------+/                                 t------------------------+----++-------------/  
                                                 |          t------+-----------------------------------------------------------/    ||                
                                                 |                 t----------------------------------------------------------------+/                
                                                 t----------------------------------------------------------------------------------/                 `;
  //NOTE input chars that used to be "\"s must be changed to "t" to make them read right
  const testInput =
    `/->-t        
|   |  /----t
| /-+--+-t  |
| | |  | v  |
t-+-/  t-+--/  
  t------/   `;

  const testInput2 =
    `|
|
v
|
|
|
|
|
^
|`

  const inputToMatrix = str =>
    str
      .split("\n")
      .map(line => line.split(""))

  const getCarts = inputStr =>
    inputStr
      .split("\n")
      .reduce((acc, line, y) => {
        line.split("")
          .forEach((char, x, arr) => {

            switch (char) {
              case ("^"):
                acc.push({ char: char, x: x, y: y, lastTurn: "right" });
                break;
              case (">"):
                acc.push({ char: char, x: x, y: y, lastTurn: "right" });
                break;
              case ("v"):
                acc.push({ char: char, x: x, y: y, lastTurn: "right" });
                break;
              case ("<"):
                acc.push({ char: char, x: x, y: y, lastTurn: "right" });
                break;
            }
          })
        return acc
      }, [])

  const getMap = inputStr =>
    inputToMatrix(inputStr)
      .map((line, y, lines) =>
        line.map((char, x, line) => {

          if (!char.match(/[v^<>]/))
            return char;
          else {
            if (char.match(/[<>]/))
              return "-"
            else
              return "|"
            // if (line[x - 1] === "-" || line[x + 1] === "-")
            //   return "-";
            // else
            //   return "|"
          }
        }
        ))


  const handleCrossroad = (cart) => {
    switch (cart.lastTurn) {
      case ("right"):
        cart.char = cart.char === "<" ? "v" :
          cart.char === "^" ? "<" :
            cart.char === ">" ? "^" :
              ">";
        cart.lastTurn = "left";
        break;
      case ("straight"):
        cart.char = cart.char === "<" ? "^" :
          cart.char === "^" ? ">" :
            cart.char === ">" ? "v" :
              "<";
        cart.lastTurn = "right";
        break;
      case ("left"):
        cart.lastTurn = "straight";
        break;
    }
    return cart;
  }




  const handleMovementAndReturnCart = (cart, map) => {
    const getCharUnderCart = (cart) => map[cart.y][cart.x];
    switch (cart.char) {
      case ("^"):
        cart.y -= 1;
        if (getCharUnderCart(cart) === "t")
          cart.char = "<";
        if (getCharUnderCart(cart) === "/")
          cart.char = ">";
        if (getCharUnderCart(cart) === "+")
          handleCrossroad(cart);
        break;
      case ("v"):
        cart.y += 1;
        if (getCharUnderCart(cart) === "/")
          cart.char = "<";
        if (getCharUnderCart(cart) === "t")
          cart.char = ">";
        if (getCharUnderCart(cart) === "+")
          handleCrossroad(cart);
        break;
      case (">"):
        cart.x += 1;
        if (getCharUnderCart(cart) === "t")
          cart.char = "v";
        if (getCharUnderCart(cart) === "/")
          cart.char = "^";
        if (getCharUnderCart(cart) === "+")
          handleCrossroad(cart);
        break;
      case ("<"):
        cart.x -= 1;
        if (getCharUnderCart(cart) === "t")
          cart.char = "^";
        if (getCharUnderCart(cart) === "/")
          cart.char = "v";
        if (getCharUnderCart(cart) === "+")
          handleCrossroad(cart);
        break;
    }
    return cart;
  }

  const printMap = (map, carts) => {
    const newMap = map.slice(0).map(line => line.slice(0))
    document.querySelector('pre').innerHTML = "";
    carts.forEach(cart =>
      newMap[cart.y][cart.x] = cart.char)
    newMap.forEach(line =>
      document.querySelector('pre').innerText += line.join("") + "\n")

  }


  const getCollisions = carts =>
    carts
      .map(cart => "x" + cart.x + "y" + cart.y)
      .filter((str, i, arr) => !uniqueShallow(str, i, arr));

  const tickForward = (matrix, carts, limit) => {
    for (let i = 0; i < limit; i++) {
      //console.log("i:", i)
      carts = carts
        .sort((cartA, cartB) => {
          if (cartA.y - cartB.y !== 0)
            return cartA.y - cartB.y;
          else
            return cartA.x - cartB.x;
        })
        .map((cart, i, arr) => {

          handleMovementAndReturnCart(cart, matrix)
          if (getCollisions(carts).length)
            console.log(getCollisions(carts))

          return cart;

        })


    }
    return carts;
  }


  const tickForwardB = (matrix, carts, limit) => {
    for (let tick = 0; tick < limit; tick++) {
      if (!(tick % 100))
        console.log("tick:", tick)
      const cartsToBeRemoved = [];
      carts = carts
        .sort((cartA, cartB) => {
          if (cartA.y - cartB.y !== 0)
            return cartA.y - cartB.y;
          else
            return cartA.x - cartB.x;
        })
        .map((cart, i, arr) => {

          handleMovementAndReturnCart(cart, matrix)

          const collisions = getCollisions(carts);
          if (collisions.length) {

            console.log("tick:", tick, collisions, carts.length)

            collisions.forEach(coll =>
              carts.forEach(cart => "x" + cart.x + "y" + cart.y !== coll ? null : cart.markForDeletion = true))
          }
          return cart;

        })
      carts = carts.filter(cart => !cart.markForDeletion)
      if (carts.length === 1) {

        console.log("final:", carts[0])
        debugger;
      }


    }
    return carts;
  }




  let startTime = new Date()
  console.log(
    "A:",
    tickForward(
      getMap(input),
      getCarts(input),
      150
    ),
    //,
    "time:",
    new Date() - startTime,
    "ms"
  )

  startTime = new Date()
  console.log(
    "B:",
    tickForwardB(
      getMap(input),
      getCarts(input),
      650000
    ),
    //,
    "time:",
    new Date() - startTime,
    "ms"
  )


</script>